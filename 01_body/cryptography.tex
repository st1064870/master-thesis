\chapter{Κρυπτογραφία}
\label{chapter:cryptography}

Στο κεφάλαιο αυτό θα γίνει μια εισαγωγή στην Κρυπτογραφία. Αρχικά θα αναλύσουμε βασικούς ορισμούς/μοντέλα κρυπτογραφικών σχημάτων, ξεκινώντας από πιο ιστορικούς και καταλήγοντας σε πιο σύγχρονους. Πολλοί από αυτούς θα χρησιμοποιηθούν στο Κεφάλαιο \ref{chapter:security} ως βασικά δομικά στοιχεία. Στη συνέχεια του κεφαλαίου, θα αναλύσουμε κυρίως σύγχρονα κρυπτογραφικά εργαλεία και πρωτόκολλα που χρησιμοποιούνται ως συστατικά στοιχεία σε σύγχρονα πρωτόκολλα. Αυτό θα το διαπιστώσουμε και στην πράξη, αφού θα χρησιμοποιηθούν στη συνέχεια στα Κεφάλαια \ref{chapter:SMPC} και \ref{chapter:implementation}. Σε καμία περίπτωση αυτό το κεφάλαιο δεν αποτελεί μια πλήρη εισαγωγή στον κλάδο της κρυπτογραφίας. Ο αναγνώστης που ενδιαφέρεται για κάτι τέτοιο μπορεί να απευθυνθεί στα βιβλία \cite{boneh2020graduate}, \cite{hoffstein2008introduction}, \cite{pagourtzis2016computational}, το τελευταίο εκ των οποίων είναι και στην ελληνική γλώσσα.

\section{Βασικοί Ορισμοί}

\subsection{Πρωταρχικοί Ορισμοί}

Αρχικά θα αναφερθούμε στους πρώτους ιστορικά τυποποιημένους ορισμούς κρυπτογραφικών σχημάτων που έγιναν από τον Shannon, οι οποίοι αναφέρονται σε συστήματα συμμετρικής κρυπτογραφίας, με απώτερο σκοπό να μπορέσουμε να παρουσιάσουμε με σαφήνεια τα μοντέλα των αντιπάλων, της ασφάλειας ενάντια σε αυτά και των αποδείξεων αυτών στο Κεφάλαιο \ref{chapter:security}. Αυτά στη συνέχεια μπορούν να γενικευθούν, να προσαρμοστούν και να χρησιμοποιηθούν σε πολλές κατηγορίες κρυπτογραφικών σχημάτων, όπως αυτές της ασύμμετρης κρυπτογραφίας, των συναρτήσεων κατακερματισμού, των κρυπτογραφικών πρωτοκόλλων κ.α.

Ο Shannon στην εργασία \cite{shannon1945mathematical} όρισε το παρακάτω γενικό μαθηματικό μοντέλο συμμετρικού κρυπτογραφικού σχήματος.

\begin{definition}
\label{def:shannon_cipher}
\textbf{Κρυπτογραφικό Σχήμα Shannon (Shannon Cipher)} : Ένα ζεύγος ντετερμινιστικών συναρτήσεων $\mathcal{E} = (\enc, \dec)$ οι οποίες ορίζονται ως εξής:
\begin{itemize}
    \item $\enc$ : $\mathcal{K} \times \mathcal{M} \rightarrow \mathcal{C}$
    \item $\dec$ : $\mathcal{K} \times \mathcal{C} \rightarrow \mathcal{M}$
\end{itemize}
όπου $\mathcal{M}$, $\mathcal{C}$, $\mathcal{K}$ είναι οι χώροι των μηνυμάτων, κρυπτοκειμένων και κλειδιών αντίστοιχα τους οποίους θα θεωρήσουμε πεπερασμένους. Στην περίπτωση αυτή λέμε ότι το κρυπτοσύστημα $\mathcal{E}$ ορίζεται πάνω στο $(\mathcal{K},\mathcal{M},\mathcal{C})$. Οι συναρτήσεις $\enc, \dec$ ορίζονται ως εξής:

\begin{itemize}
    \item H $\enc$ είναι η συνάρτηση κρυπτογράφησης και παίρνει ως όρισμα ένα κλειδί $k \in \mathcal{K}$ και ένα μήνυμα $k \in \mathcal{M}$ και επιστρέφει ένα κρυπτοκείμενο $c \in \mathcal{C}$. Δηλαδή :
    $$
    c = \enc_k(m) \text{ ή με ισοδύναμο συμβολισμό } c = \enc(k, m)
    $$
    \item H $\dec$ είναι η συνάρτηση αποκρυπτογράφησης, δηλαδή η αντίστροφη συνάρτηση της \enc, και παίρνει ως όρισμα ένα κλειδί $k \in \mathcal{K}$ και ένα κρυπτοκέιμενο  $c \in \mathcal{C}$ και επιστρέφει ένα μήνυμα $m \in \mathcal{M}$. Δηλαδή : 
    $$
    m = \dec_k(c) \text{ ή με ισοδύναμο συμβολισμό } m = \dec(k, c)
    $$
    %
\end{itemize}
    Όπου οι $\enc$, $\dec$ ακολουθούν την παρακάτω Ιδιότητα Ορθότητας:
    \begin{equation}
    \label{shannon_decryption_identity}
    \forall m \in \mathcal{M}, \forall k \in \mathcal{K} : Pr[m = \dec_k(\enc_k(m))] = 1
    \end{equation}
\end{definition}
{\setlength{\parindent}{0cm}
Ένα παράδειγμα Κρυπτογραφικού Σχήματος Shannon είναι αυτό του Σημειωματάριου Μιας Χρήσης (One Time Pad ή OTP) \cite{miller1882telegraphic} με σταθερό ή και μεταβλητό μήκος $m$ και $c$.
}

Δυστυχώς, ο Ορισμός \ref{def:shannon_cipher} είναι πολύ γενικός και η κλάση των κρυπτογραφικών σχημάτων που ορίζει, συμπεριλαμβάνει προβλήματα με μη πρακτικές χρονικές και χωρικές πολυπλοκότητες. Έτσι, υπήρξε ανάγκη στη βιβλιογραφία να συμπεριληφθεί μια ακόμα κλάση κρυπτογραφικών σχημάτων που εμπεριέχει, αποκλειστικά, κρυπτογραφικά σχήματα που μπορούν να υλοποιηθούν αποδοτικά.

\begin{definition}
\label{def:computational_cipher}
\textbf{Υπολογιστικό Κρυπτογραφικό Σχήμα (Computational Cipher) \cite{boneh2020graduate}} : Ένα ζεύγος συναρτήσεων $\mathcal{E} = (\enc, \dec)$ όπως ορίζονται στο Κρυπτογραφικό Σχήμα Shannon υπό τον περιορισμό ότι οι αλγόριθμοι $\enc$, $\dec$ είναι αποδοτικοί και πιθανοτικοί δηλαδή, $\enc, \dec \in PPT(\secparam)$, όπου $\secpar$ παράμετρος ασφάλειας, διατηρώντας την Ιδιότητα Ορθότητας \ref{shannon_decryption_identity}.
\end{definition}

Σήμερα για την ασφαλή ανταλλαγή μηνυμάτων\footnote{Η ασφαλής ανταλλαγή μηνυμάτων δεν αποτελεί αντικείμενο αυτής της εργασίας, ωστόσο επειδή η κρυπτογραφία ιστορικά προέκυψε από την ανάγκη για ασφαλή ανταλλαγή μηνυμάτων, θεωρούμε σημαντικό να αναφερθούμε σε αυτή στα πλαίσια μιας εισαγωγής στην κρυπτογραφία} διακρίνονται δύο κύριες κατηγορίες Υπολογιστικών Κρυπτογραφικών Σχημάτων. Τα Συμμετρικά και Ασύμμετρα Κρυπτογραφικά σχήματα, με τη λέξη "Υπολογιστικά", να παραλείπεται και να αναφέρεται μόνο όπου υπάρχει ανάγκη διάκρισης από άλλα σχήματα, αφού κυρίως μας ενδιαφέρουν πρακτικά σχήματα και σε αυτά θα επικεντρωθούμε και στα πλαίσια αυτής της εργασίας.

\subsection{Συμμετρική Κρυπτογραφία}

Η συμμετρική κρυπτογραφία παίρνει το όνομά της από τη συμμετρική χρήση κλειδιών, δηλαδή το ίδιο κλειδί που θα χρησιμοποιηθεί για την κρυπτογράφηση θα πρέπει να χρησιμοποιηθεί και για την αποκρυπτογράφηση. Στην κατηγορία των συμμετρικών κρυπτογραφικών σχημάτων ανήκουν τα περισσότερα σχήματα και συστήματα της Κλασσικής Κρυπτογραφίας.

\begin{definition}
\label{def:symetric_cryptographic_scheme}
\textbf{Συμμετρικό Κρυπτογραφικό Σχήμα (\EN{Symmetric Cryptographic \\ Scheme})} : Έστω κατάλληλα $\mathcal{M}$, $\mathcal{C}$, $\mathcal{K}$. Αποτελείτε από ένα σύνολο αποδοτικών αλγορίθμων $(\kgen, \enc, \dec)$ οι οποίοι ορίζονται παρόμοια με τον Ορισμό \ref{def:computational_cipher} και έχουν τις εξής λειτουργίες :
\begin{itemize}
    \item $k \leftarrow \kgen(1^\secpar)$ : Δημιουργεί ένα κρυπτογραφικό κλειδί $k$ το οποίο χρησιμοποιείται τόσο για κρυπτογράφηση όσο και για αποκρυπτογράφηση.
    \item $c \leftarrow \enc_{k}(m)$ : Κρυπτογραφεί ένα μήνυμα $m$ χρησιμοποιώντας το κλειδί $k$.
    \item $m \leftarrow \dec_{k}(c)$ : Αποκρυπτογραφεί ένα κρυπτοκείμενο $c$ χρησιμοποιώντας το κλειδί $k$.
\end{itemize}
Οι παραπάνω αλγόριθμοι πρέπει να ακολουθούν την εξής Ιδιότητα Ορθότητας όπως ακριβώς και με τον Ορισμό \ref{def:computational_cipher}.
\end{definition}

Ένα από τα βασικότερα μειονεκτήματα των συμμετρικών κρυπτογραφικών σχημάτων είναι ότι στην περίπτωση που χρησιμοποιούνται για ασφαλή επικοινωνία για κάθε συμμετέχοντα που θέλει να συμμετάσχει στην επικοινωνία θα πρέπει κάθε άλλος συμμετέχοντας να διαθέτει για την επικοινωνία τους ένα μοναδικό κλειδί. Δηλαδή στην περίπτωση των $n$ συμμετεχόντων θα χρειαστούμε $n^2$ κλειδιά, το πρόβλημα αυτό είναι γνωστό και ως Πρόβλημα των Τετραγώνων στη βιβλιογραφία. Έτσι τα σχήματα αυτά, από μόνα τους, καθίστανται ανίκανα για χρήση σε μεγάλα δίκτυα επικοινωνίας, όπως το Διαδίκτυο ή το Διαδίκτυο των Πραγμάτων. Ένα ακόμη μειονέκτημα είναι ότι οι συμμετέχοντες θα πρέπει να έχουν προαποφασίσει ένα συμμετρικό το συμμετρικό τους κλειδί. Τα προβλήματα αυτά έλυσε η εφεύρεση της ασύμμετρης κρυπτογραφίας. Τέλος, σημαντικό είναι να αναφέρουμε ότι αυτά τα κρυπτογραφικά σχήματα λόγω του μεγάλου τους πλεονεκτήματος να έχουν πολύ γρήγορες υλοποιήσεις χρησιμοποιούνται κατά κόρον σήμερα για μεταφορά μεγάλου όγκου δεδομένων.

\subsection{Ασύμμετρη Κρυπτογραφία}

Ο σημαντικός ρόλος της Ασύμμετρης Κρυπτογραφίας στην ιστορία της κρυπτογραφίας, παρουσιάστηκε συνοπτικά στο Κεφάλαιο \ref{chapter:intro}. Ο ορισμός των αντίστοιχων κρυπτογραφικών σχημάτων είναι παρόμοιος με αυτόν των συμμετρικών, με την κύρια διαφορά ότι υπάρχει ένα ζεύγος κλειδιών, το δημόσιο και το ιδιωτικό. Στην περίπτωση ενός ατόμου, το δημόσιο του κλειδί μπορεί να το διανέμει, προφανώς, δημόσια στο κοινό από το οποίο θέλει να δέχεται μηνύματα ενώ το ιδιωτικό, προφανώς, πρέπει να το κρατήσει μυστικό ώστε να μπορεί μόνο αυτός να διαβάζει το περιεχόμενο των μηνυμάτων που προορίζονται για αυτόν. Ο αυστηρώς ορισμός της παρουσιάζεται παρακάτω :

\begin{definition}
\label{def:assymetric_cryptographic_scheme}
\textbf{Ασυμμετρικό Κρυπτογραφικό Σχήμα (\EN{Assymetric Cryptographic \\ Scheme})} : Ορίζεται παρόμοια με τον Ορισμό \ref{def:symetric_cryptographic_scheme} με μοναδική διαφορά το ζέυγος κλειδιών και την ιδιότητα ορθότητας. Αποτελείτε από ένα σύνολο αλγορίθμων $(\kgen, \enc, \dec)$ με τις εξής λειτουργίες :
\begin{itemize}
    \item $(pk, sk) \leftarrow \kgen(1^\secpar)$ : Δημιουργεί ένα ζεύγος ασύμμετρων κρυπτογραφικά κλειδιών. Το Δημόσιο Κλειδί (Public Key) $pk$ που χρησιμοποιείται στην κρυπτογράφηση και το αντίστοιχο Ιδιωτικό Κλειδί (Private Key) $sk$ που χρησιμοποιείται στην αποκρυπτογράφηση.
    \item $c \leftarrow \enc_{pk}(m)$ : Κρυπτογραφεί ένα μήνυμα $m$ χρησιμοποιώντας το δημόσιο κλειδί $pk$.
    \item $m \leftarrow \dec_{sk}(c)$ : Αποκρυπτογραφεί ένα κρυπτοκείμενο $c$ χρησιμοποιώντας το ιδιωτικό κλειδί $sk$.
\end{itemize}
Όπως και στην περίπτωση της Συμμετρικής Κρυπτογραφίας οι παραπάνω αλγόριθμοι πρέπει να ακολουθούν την εξής ιδιότητα ορθότητας :
\[
    Pr[\dec_{sk}(\enc_{pk}(m))) = m] = 1
\]
Τα κρυπτογραφικά αυτά σχήματα ικανοποιούν επίσης της εξής ιδιότητα :
\[
Pr[\dec_{sk}(\enc_{pk}(m))) = Pr(\enc_{sk}(\dec_{pk}(m))
] = 1
\]
\end{definition}

Η τελευταία, ιδιότητα δηλαδή ότι $\dec_pk(m)=\enc^{-1}_sk(m)$ δίνει και τη δυνατότητα για την υποστήριξη ψηφιακών υπογραφών, δηλαδή την υποστήριξη της ιδιότητας της Αυθεντικότητας και της αποστολής μηνυμάτων με ένα ζεύγος κλειδιών ανά συμμετέχοντα.

Η Ασύμμετρη Κρυπτογραφία λύνει το πρόβλημα της διανομής κρυπτογραφικών κλειδιών που υπάρχει στην περίπτωση της Συμμετρικής, καθότι ο κάθε συμμετέχων χρειάζεται να διαθέτει μόνο ένα ζεύγος κλειδιών, από τα οποία το ένα μπορεί να το μοιραστεί δημόσια. Επίσης, μπορεί να χρησιμοποιηθεί ως συστατικό στοιχείο σε πολλά πρωτόκολλα με σκοπούς πέραν της απλής ανταλλαγής μηνυμάτων και των ψηφιακών υπογραφών, που θα ήταν αδύνατα χωρίς την ασύμμετρη κρυπτογραφία. Ωστόσο, αν και πρόκειται για σύγκριση ανόμοιων πραγμάτων, τα ασύμμετρα κρυπτογραφικά σχήματα είναι πιο κοστοβόρα (αρκετές δεκάδες φορές για μικρό μέγεθος μηνυμάτων και εώς και μια τάξη μεγέθους για μεγάλο μέγεθος μηνυμάτων) σε σχέση με τα συμμετρικά από άποψη υπολογισμών και πόρων στις υλοποιήσεις τους. Ένα απλό παράδειγμα φαίνεται στο Σχήμα \ref{code:rsa_vs_aes}\footnote{Είναι σημαντικό αναφέρουμε ότι σχεδόν όλοι οι σύγχρονοι CISC επεξεργαστές διαθέτουν εξειδικευμένα κυκλώματα καθώς και αντίστοιχες εντολές μηχανής και συμβολική γλώσσας για το κρυπτογραφικό σχήμα AES κάτι που σε καμία περίπτωση δεν ισχύει για τον RSA. Το τελευταίο οφείλεται και στο ότι η φύση τελευταίου δεν επιδέχεται μεγάλο βαθμό παραλληλοποίησης.} στο οποίο συγκρίνονται οι χρόνοι εξεργαστή (CPU time) κρυπτογράφησης και αποκρυπτογράφησης ενός μικρού μηνύματος για τα σχήματα RSA και AES. Έτσι, σήμερα σε αρκετά δημοφιλή κρυπτογραφικά πρωτόκολλα, όπως για παράδειγμα στο πρωτόκολλο TLS 1.3 \cite{RFC8446}, που χρησιμοποιείται για την ασφαλή επικοινωνία στα Επίπεδα Δικτύου OSI 4-7 ενός δικτύου. Στην αρχή μιας συνεδρίας TLS 1.3 χρησιμοποιούνται ασύμμετρα σχήματα ψηφιακών υπογραφών και ανταλλαγής κλειδιών, όπως τα ECDSA και ECDHE αντίστοιχα, με σκοπό τη δημιουργία από κοινού συμμετρικών κλειδιών που χρησιμοποιούνται στη συνέχεια από συμμετρικούς αλγορίθμους για την κρυπτογράφηση των δεδομένων της επακόλουθης συνεδρίας. Ακόμα, ένα από τα κύρια χαρακτηριστικά των ασύμμετρων σχημάτων είναι η αυξημένη μαθηματική τους δόμηση. Αυτό έχει ως αποτέλεσμα συνήθως να βασίζονται έμμεσα σε πιο πολύπλοκους μαθηματικούς υπολογισμούς, όπως η εύρεση μεγάλων πρώτων αριθμών σε σχέση με τους σχετικά απλούς υπολογισμούς που εκτελεί ένα συμμετρικό σχήμα. Μια ακόμα συνέπεια του χαρακτηριστικού της αυξημένης μαθηματικής τους δόμησης, είναι ότι η ασφάλεια τους κατά κόρον βασίζεται σε υποθέσεις πολυπλοκότητας, όπως αυτές που θα αναφερθούν στην Κεφάλαιο \ref{chapter:security}, από τις οποίες πολλές από αυτές έχει αποδειχθεί ότι δεν ισχύουν σε μη κλασσικά μοντέλα υπολογισμού, όπως το κβαντικό \cite{shor1994algorithms}, αλλά και κάνουν την απόδειξη της ασφάλειας τους πιο πολύπλοκη.

\begin{figure}[h]
    \begin{center}
        \inputminted[fontsize=\scriptsize,frame=single]{python}{./01_body/code/rsa-vs-aes.py}
        \inputminted[fontsize=\scriptsize,frame=single]{text}{./01_body/code/rsa-vs-aes.output}
    \end{center}
    \caption{Μικρή σύγκριση των επιδόσεων για την κρυπτογράφηση και την αποκρυπτογράφηση ενός απλού μηνύματος μεταξύ συμμετρικών και ασύμμετρων κρυπτογραφικών σχημάτων (AES, RSA).}
    \label{code:rsa_vs_aes}
\end{figure}

\section{Κρυπτογραφικά Εργαλεία}

Στην Ενότητα αυτή θα μελετήσουμε σύγχρονα κρυπτογραφικά εργαλεία που αποτελούν βασικά συστατικά στοιχεία πολλών Κρυπτογραφικών Πρωτοκόλλων με διάφορες εφαρμογές. Πολλά από αυτά παρατηρούνται συχνά σε πρωτόκολλα SMPC κάτι που θα το παρατηρήσουμε πρακτικά και στο Κεφάλαιο \ref{chapter:SMPC}.

\subsection{Σχήματα Δέσμευσης (Commitment Schemes)}

Τα Σχήματα Δέσμευσης (Commitment Schemes) είναι το πρώτο εργαλείο που θα εξετάσουμε. Αυτά έχουν τη μορφή πρωτοκόλλων επικοινωνίας δύο φάσεων (Δέσμευση και Άνοιγμα) μεταξύ δύο ή περισσότερων συμμετεχόντων. Παρέχουν τη δυνατότητα σε έναν συμμετέχον, $S$, να δεσμευτεί κάποια συγκεκριμένη τιμή σε κάποιον άλλον, $R$, χωρίς όμως να γνωρίζει ο $R$ τη συγκεκριμένη τιμή, δηλαδή η τιμή είναι σε κρυπτογραφημένη μορφή. Το πρωτόκολλο δίνει τη δυνατότητα να αποκαλυφθεί στον $R$ η τιμή στην οποία δεσμεύτηκε αρχικά ο $S$, και μόνο αυτή, σε επόμενη χρονική στιγμή την οποία επιλέγει ο συμμετέχον $S$. Αυτό αποτρέπει τον συμμετέχον $S$ στο να μεταβάλλει την τιμή αυτή χωρίς να γίνει αντιληπτό από τον άλλο συμμετέχων.

Μπορούμε να αντιληφθούμε καλύτερα αυτό τον μηχανισμό λειτουργίας μέσα από ένα παράδειγμα της πραγματικής ζωής. Αν υποθέσουμε ότι η τιμή δέσμευσης είναι κάποιο αντικείμενο, τότε ο $S$ μπορεί να το κλείσει και να το κλειδώσει σε ένα κουτί για το οποίο έχει το κλειδί και στη συνέχεια να το δώσει στον $R$ να το κρατήσει στην κατοχή του. Όταν ο $S$ αποφασίσει να αποκαλύψει το αντικείμενο στον $R$, τότε του δίνει το κλειδί για να το ανοίξει. Ο μηχανισμός που λειτουργούν τα σχήματα αυτά είναι παρόμοιος με αυτόν ενός Ασύμμετρου Κρυπτογραφικού Σχήματος. Τα σχήματα αυτά χρησιμοποιούνται ως δομικά στοιχεία σε σχήματα Αποδείξεων Μηδενικής Γνώσης αλλά και στον Πρωτόκολλα Ασφαλούς Υπολογισμού Πολλών Μερών. Τα Σχήματα Δέσμευσης ορίζονται ως εξής :

\begin{definition}
    \textbf{Σχήματα Δέσμευσης} : Έστω $Μ$ ο χώρος των μηνυμάτων, $C$ ο χώρος των δεσμευμένων τιμών, $D$ ο χώρος των κλειδιών αποδέσμευσης και $\mathbb{R}$ μια ομοιόμορφη πιθανοτική κατανομή που περιέχει εντροπία για τον σκοπό μας. Τα σχήματα δέσμευσης είναι πρωτόκολλα δύο συμμετεχόντων, ας τους ονομάσουμε $S$ και $R$, στα οποία ο $S$ δεσμεύετε μια τιμή στον $R$ στην αρχή του πρωτοκόλλου και σε κάποια επόμενη χρονική στιγμή την οποία επιλέγει ο $S$ αποκαλύπτει (ανοίγει) την τιμή αυτή στον $R$. Αποτελούνται από μια τριάδα αλγορίθμων $(\text{Setup}, \text{Commit}, \text{Verify})$ που ορίζονται ως εξής :
    \begin{itemize}
        \item $pk \gets \text{Setup(\secparam)}$ : Δημιουργεί το δημόσιου κλειδί του σχήματος στο οποίο πρέπει να έχουνε πρόσβαση και οι δύο συμμετέχοντες.
        \item $(c,d) \gets \text{Commit}_{pk}(m, r)$ : Δέχεται ως ορίσματα ένα μήνυμα $m$ και μερικά τυχαία νομίσματα $r \sample \mathbb{R}$, και δίνει ως εξόδους μια δεσμευμένη τιμή $c$ και ένα κλειδί αποδέσμευσης $d$ για την $c$.
        \item $\text{Open}_{pk}(c, m, d)$ : Δέχεται ως ορίσματα μια δεσμευμένη τιμή $c$, το μήνυμα $m$ και το κλειδί ανοίγματος $d$, και δίνει ως έξοδο μια δυαδική τιμή ανάλογα με το αν η τιμή που φανερώθηκε από την αποδέσμευση της $c$ μέσω της $d$ είναι η $m$.
    \end{itemize}
    Το σχήμα πρέπει να ικανοποιεί τις παρακάτω ιδιότητες, οι οποίες ορίζονται με την βοήθεια ενός Παιχνιδιού ασφάλειας. Τα παιχνίδια αυτά δεν τα έχουμε εξετάσει ακόμα, οπότε η σημειολογία τους θα γίνει αντιληπτή στο επόμενο κεφάλαιο :
    \begin{itemize}
        \item \textbf{Ορθότητα (Completeness)} : $\forall pk, \forall m \in M, \forall r \sample \mathbb{R}$ :
        \[
            \operatorname{Pr}[\text{Open}_{pk}(\text{Commit}_{pk}(m, r), m)] = 1
        \]
        \item \textbf{Δέσμευση (Binding)} : Έστω ο αλγόριθμος που φαίνεται στο Σχήμα \ref{def:commitment_schemes_binding_property_game}. Η ιδιότητα αυτή ορίζεται ως εξής :
        \[
            \forall \adv \in \text{ μη-ομοιόμορφους PPT : }  \operatorname{Pr}[\text{Binding-Game}^{\adv} = 1] \leq ε_h
        \]
        \item \textbf{Απόκρυψη (Hiding)} : Έστω ο αλγόριθμος που φαίνεται στο Σχήμα \ref{def:commitment_schemes_hiding_property_game}. Η ιδιότητα αυτή ορίζεται ως εξής :
        \[
            \forall A \in \text{ μη-ομοιόμορφους PPT : }
        \abs{\operatorname{Pr}[\text{Hiding-Game}^{\adv}] - \sfrac{1}{2}} \leq ε_h
        \]
    \end{itemize}
\end{definition}

\begin{figure}[H]
    \centering
\subfloat[$\text{Binding-Game}^{\adv}$]{%
    \begin{pchstack}[center, boxed]
        \procedure[linenumbering]{Binding-Game^{\adv}} {
            pk \gets \text{Setup(\secparam)} \\
            (c, d, d') \gets \adv(pk) \\
            m_0 \gets \text{Open}_{pk}(c, d) \\
            m_1 \gets \text{Open}_{pk}(c, d') \\
            \pcif (m=\perp) \lor (m'=\perp) \\
            \pcreturn 0 \\
            \pcelse \\
            \pcreturn \neg [m \stackrel{?}{=} m'] \\
            \pcendif
        }
    \end{pchstack}
    \label{def:commitment_schemes_binding_property_game}
}\qquad
\subfloat[$\text{Hiding-Game}^{\adv}$]{%
    \begin{pchstack}[center, boxed]
        \procedure[linenumbering]{Hiding-Game^{\adv}} {
            pk \gets \text{Setup(\secparam)} \\
            (m_0, m_1) \gets \adv(pk) \\
            \b \sample \bin \\
            (c,d) \gets Com_pk(m_b) \\
            \pcreturn \adv(c)
        }
    \end{pchstack}
    \label{def:commitment_schemes_hiding_property_game}
}
    \caption{Παιχνίδια ασφάλειας για τους ορισμούς των ιδιοτήτων Δέσμευσης (Binding) και Απόκρυψης (Hiding) ενός Σχήματος Δέσμευσης.}
\end{figure}

Οι τιμές $ε_h$ και $ε_b$ εξαρτόνται από το είδος της ιδιότητας που θέλουμε να έχουμε. Σε αντιστοιχία με τους ορισμούς ασφάλειας αλλά και με την ισχύ του αντιπάλου που θα ορίσουμε στο επόμενο κεφάλαιο, μπορούμε να έχουμε Υπολογιστική, Στατιστική ή Τέλεια Απόκρυψη και Δέσμευση και οι τιμές που λαμβάνουν οι $ε_h$ και $ε_b$ είναι $0$, $negl(\secparam)$ και  $negl(\secparam)$ αντίστοιχα. Μπορεί να αποδειχθεί σχετικά εύκολα, ότι δεν μπορούν να υπάρξουν σχήματα που να διαθέτουν ταυτόχρονα, Τέλεια Απόκρυψη και Τέλεια Δέσμευση. Τέλος, μια πολύ ενδιαφέρουσα εισαγωγική εργασία επί τον Σχήμάτων Δέσμευσης αλλά και των Αποδείξεων Μηδενικής γνώσης που θα εξετάσουμε αμέσως μετά, είναι η \cite{damgaard1998commitment}.

\subsection{Αποδείξεις Μηδενικής Γνώσης}

Το επόμενο εργαλείο που θα εξετάσουμε είναι αυτό τον Αποδείξεων Μηδενικής Γνώσης. Η Μηδενική Γνώση είναι μια ιδιότητα που μπορεί να αποκτήσει η κλάση $\IP$ των Διαδραστικών Αποδείξεων αν υποθέσουμε ότι υπάρχουν Συναρτήσεις Μονής Διαδρομής (One Way Functions ή OWF), μια υπόθεση που θα δούμε στο επόμενο κεφάλαιο. Στο Κεφάλαιο \ref{chapter:appendix} κάνουμε μια μικρή μελέτη στις διαδραστικές αποδείξεις που είναι άμεσα συσχετισμένες με τις Αποδείξεις Μηδενικής Γνώσης. Διαισθητικά σε ένα πρωτόκολλο με την ιδιότητα αυτή ο Αποδεικνύων $P$, μπορεί να αποδείξει στον Επαληθευτή $V$ ότι γνωρίζει κάποιο στοιχείο $w$ που ανήκει σε μια προκαθορισμένη γλώσσα $L$ που γνωρίζουν και οι δύο οντότητες, χωρίς ο $V$ να μπορεί να αποκτήσει γνώση σχετικά με το ποιο είναι το $w$. Μια πιο παραστατική αντίληψη του πως λειτουργούν οι αποδείξεις με την ιδιότητα αυτή παρουσιάζεται στο Σχήμα \ref{fig:zero_knowledge_comic}. Σχετικά με τον αυστηρό ορισμό της ιδιότητας της Μηδενικής Γνώσης, χρειάστηκαν αρκετά χρόνια ώστε να υπάρξει ένας καταληκτικός ορισμός στη βιβλιογραφίας. Αυτός παρουσιάζεται παρακάτω σε αντιστοιχία με τον ορισμό της κλάσης IP:

\begin{figure}[hb]
    \centering
    \includegraphics[width=10cm]{./01_body/images/zero_knowledge_comic.png}
    \caption{Κόμικ που αναπαριστά πως λειτουργούν οι Αποδείξεις Μηδενικής Γνώσης \cite{goldreich2013short}.}
    \label{fig:zero_knowledge_comic}
\end{figure}

\begin{definition}
\label{def:czk}
\textbf{Κλάση Αποδείξεων Μηδενικής Γνώσης (\EN{Computational Zero Knowledge Proofs} ή $\CZK$)} : Έστω $P$ μια ντετερμινιστική ΤΜ που είναι απεριόριστης ισχύος. Η γλώσσα $L$ λέμε ότι ανήκει στην κλάση $\IP$, δηλαδή $L \in \CZK$ αν υπάρχει μη ντετερμινιστική πολυωνυμική ΤΜ $V$ με εισόδους $x, r, a_{1}, \ldots, a_{i}$ και χρονική πολυπλοκότητα σε $O(poly(|x|))$ που ικανοποιεί τις παρακάτω ιδιότητες :
\begin{itemize}
    \item \textbf{Πληρότητα (Completeness)} : $x \in L \Rightarrow \exists \operatorname{Pr}\left[\text{out}_{V}\langle V, P\rangle(x)=1\right] \geq (ε=) \dfrac{2}{3}$
    \item \textbf{Ορθότητα (Soundness)} : $x \notin L \Rightarrow \forall \operatorname{Pr}\left[\text{out}_{V}\langle V, P\rangle(x)=1\right] \leq 1 - ε$
    \item \textbf{Μηδενική Γνώση} : $\forall V, \exists S \in \text{ μη-ομοιόμορφους } PPT : \forall x \in L$ :
    \[
    View_V = S(x)
    \]
\end{itemize}
\end{definition}

Προφανώς, όπως ισχύει και για τις ιδιότητες της Πληρότητας και της Ορθότητας των Διαδραστικών Αποδείξεων έτσι και για την ιδιότητα της Μηδενικής Γνώσης μπορούμε να έχουμε από τους αντίστοιχους ορισμούς ασφάλειας που θα παρουσιαστούν στο επόμενο κεφάλαιο, \textbf{Τέλεια}, \textbf{Στατιστική} ή \textbf{Υπολογιστική Μηδενική Γνώση} ανάλογα με τον τύπο της δυσδιακριτότητας των κατανομών της μηδενικής γνώσης και οι κλάσεις που ορίζουν είναι οι PZK, SZK και $\CZK$ αντίστοιχα. Για τις κλάσεις αυτές γνωρίζουμε ότι $\text{PZK} \subseteq \text{SZK} \subseteq \text{CZK}$. Η ευρύτερη από αυτές τις κλάσεις είναι αυτή της $\CZK$ που παρουσιάστηκε και στον Ορισμό \ref{def:czk}. Για την κλάση $\CZK$ γνωρίζουμε ότι $\IP=\CZK=\PSPACE$ και ότι $\NP \subseteq \CZK$, προφανώς υπό την υπόθεση OWF \cite{ben1988everything}. Για τις κλάσεις $\SZK$ και $\PZK$ ωστόσο δεν έχει αποδειχθεί κάποια παρόμοια ισότητα αλλά γνωρίζουμε το εξής $\PZK \subseteq \SZK \subseteq \AM \cap \coAM$ και επίσης εικάζεται ότι δεν ισχύει $\NP \subseteq \SZK$ καθώς τότε καταρρέει όλη η πολυωνυμική ιεραρχία της $\NP$. Μια σύνοψη της γνώσης που έχουμε προς το παρόν για τις τρεις προηγούμενες κλάσεις, συμπεριλαμβανομένων και αρκετών σχέσεων που παραλήψαμε για λόγους συνοπτικότητας, μπορεί να βρεθεί στην εργασία \cite{couteau2017zero}. Δεν μπορούμε να παραλείψουμε να αναφέρουμε δύο σημαντικές κλάσεις που σχετίζονται άμεσα με την $\CZK$, αυτή των Μη Διαδραστικών Αποδείξεων Μηδενικής Γνώσης, NIZK, και αυτή των Πιθανοτικά Ελεγχόμενων Αποδείξεων $\PCP$, ωστόσο η μελέτη τους εμπείπτει εκτός τον σκοπών αυτής της εργασίας.

Παρακάτω παρουσιάζεται ένα από τα πιο γνωστά σχήματα μηδενικής γνώσης, το Πρωτόκολλο Schnorr που μπορεί να χρησιμοποιηθεί για να αποδειχθεί η γνώση μιας λύσης ενός στιγμιότυπου του προβλήματος του Διακριτού Λογαρίθμου, δηλαδή η γνώση ενός στοιχείου $x$, τέτοιου ώστε $h=g^x$.

\begin{definition}
    \textbf{Πρωτόκολλο Schnorr : Απόδειξη Μηδενικής Γνώσης για τον Διακριτό Λογάριθμο} \cite{cramer1994proofs} :
    Έστω μια πολλαπλασιαστική ομάδα $G$, πρώτης τάξης με $\abs{G}=q$.
\begin{framed}
    \begin{itemize}
        \item \textbf{Εισόδοι} :
            \begin{itemize}
                \item $P$ : $x$, $h$
                \item $V$ : $h$
            \end{itemize}
        \item \textbf{Πρωτόκολλο} : 
            \pcb {
                P \< \< V \\ [][\hline]
                r \sample \mathbb{Z_q} \< \< \\
                u \gets g^r \< \< \\
                \< \sendmessageright*{u} \< \\
                \< \< c \sample \mathbb{Z}_q \\
                \< \sendmessageleft*{c} \< \\
                z \gets r + cx \< \< \\
                \< \sendmessageright*{z} \< \\
                \< \< g^z \stackrel{?}{=} u \cdot h^c
            }
        \item \textbf{Εξόδοι} :
            \begin{itemize}
                \item $P$ : $\perp$
                \item $V$ : $0$ ή $1$ ανάλογα με το αν ισχύει η τελευταία πράξη ισότητας που εκτέλεσαι
            \end{itemize}
    \end{itemize}
            \end{framed}
\end{definition}

\subsection{Σχήματα Ανυποψίαστης Μεταφοράς}

Τα σχήματα Ανυποψίαστης Μεταφοράς (Oblivious Transfer ή OT) είναι το επόμενο κρυπτογραφικό εργαλείο που θα μελετήσουμε. Πρόκειται για πρωτόκολλα δύο συμμετεχόντων, έστω $P_1$, $P_2$, στα οποία ο ένας συμμετέχον έχει $n$ τιμές και από τις οποίες ο άλλος συμμετέχον μπορεί να επιλέξει $t \le n$ από αυτές δίχως ο πρώτος συμμετέχον να γνωρίζει ποιες επέλεξε ο δεύτερος. Ίσως, να ακούγεται ανόητη η χρησιμότητα τους όμως έχει αποδειχθεί ότι έχουν πολύ μεγάλη σημασία και δίχως σχήματα OT πολλά σύνθετα δεν μπορούν να υλοποιηθούν. Για να αντιληφθούμε τη σημασία τους, έχει αποδειχθεί πως με βάση μόνο σχήματα OT μπορεί να υπολογιστεί οποιαδήποτε SMPC συνάρτηση \cite{10.1561/3300000019}. Το πρώτο πρωτόκολλο Ανυποψίαστης Μεταφοράς παρουσιάστηκε στη βιβλιογραφία το 1981 από τον Rabin, στην εργασία \cite{cryptoeprint:2005/187}. Μπορούμε να μοντελοποιήσουμε τα σχήματα αυτά ως εξής :

\begin{definition}
\textbf{Πρωτόκολλο Ανυποψίαστης Μεταφοράς t από τα n (Oblivious Transfer ή ΟΤ t-out-of-n)} :
Έστω δύο συμμετέχοντες $P_1$, $P_2$ όπου ο πρώτος διαθέτει $n$ τιμές από τις οποίες ο δεύτερος καλείται να επιλέξει $t$. Τότε το πρωτόκολλο μοντελοποιείται ως :
\begin{itemize}
    \item \textbf{Εισόδοι} :
        \begin{itemize}
            \item $P_1$ : $b_{0}, b_{1}, \ldots b_{n} \in \bin^l$
            \item $P_2$ : $σ_{0}, σ_{1}, \ldots σ_{n} \in \bin$
        \end{itemize}
    \item \textbf{Εξόδοι} :
        \begin{itemize}
            \item $P_1$ : $\perp$
            \item $P_2$ : \{$\forall σ_i : b_{\{σ_i = 1\}}\}$, όπου $|{σ_i=1}|=t$
        \end{itemize}
\end{itemize}
\end{definition}

Πολλές φορές στη βιβλιογραφία χρησιμοποιείται ο συμβολισμός OT t/n ή OT t-n, δηλαδή για παράδειγμα OT 1-2 ή OT 1/2. Παρακάτω παρουσιάζεται ένα πρωτόκολλο για OT 1-2 που είναι Σημασιολογικά Ασφαλές απέναντί σε Παθητικούς Αντιπάλους και παρουσιάστηκε στην εργασία \cite{even1985randomized}.

\begin{definition}
\label{def:oblivious_transfer}
\textbf{Πρωτόκολλο Ανυποψίαστης Μεταφοράς 1/2 (Oblivious Transfer 1/2)} \cite{even1985randomized} :
Έστω δύο συμμετέχοντες $P_1$, $P_2$ όπου ο πρώτος διαθέτει δύο τιμές $b_0$, $b_1$ από τις οποίες ο δεύτερος καλείται να επιλέξει μία και διαθέτει ένα bit επιλογής $σ$.
\begin{mdframed}
\begin{itemize}
\item \textbf{Εισόδοι} : 
    \begin{itemize}
    \item Κοινή είσοδος : Οικογένεια Μεταθέσεων Κερκόπορτας (Trapdoor Permutations ή TDP) : $(I, S, F, F^{-1})$, Hardcore Predicate : $B$
    \item $P_{1}$ : $b_{0}, b_{1} \in\{0,1\}$
    \item $P_{2}$ : $\sigma \in\{0,1\}$.
    \end{itemize}
\item \textbf{Πρωτόκολλο} : \\
    \pcb {
    P_1 \< \< P_2 \\ [][\hline]
    (a, τ) \gets I(\secparam) \< \< \\
    \< \sendmessageright*{(a, t)} \> \\
    \< \< x_σ \gets S(a) \\
    \< \< y_{1-σ} \gets S(a) \\
    \< \< y_{σ} \gets F(a, x_s) \\
    \< \sendmessageleft*{y_0, y_1} \< \\
    x_0 \gets F^{-1}(a, y_0) \< \< \\
    x_1 \gets F^{-1}(a, y_1) \< \< \\
    β_0 \gets B(a, x_0) \oplus b_0 \< \< \\
    β_1 \gets B(a, x_1) \oplus b_1 \< \< \\
    \< \sendmessageright*{β_0, β_1} \< \\
    \< \< b_σ \gets B(a, x_σ) \oplus β_σ
    }

\item \textbf{Εξόδοι} :
    \begin{itemize}
        \item $P_1$ : $\perp$
        \item $P_{2}$ : $b_σ$
    \end{itemize}
\end{itemize}
    \end{mdframed}
\end{definition}

\subsection{Σχήματα Διαμοίρασης Μυστικών (Secret Sharing)}

Το τελευταίο κρυπτογραφικό εργαλείο που θα μελετήσουμε είναι αυτό των σχημάτων Διαμοίρασης Μυστικών. Για να αντιληφθούμε τη χρησιμότητα των σχημάτων Διαμοίρασης Μυστικών ας εξετάσουμε πρώτα ένα απλό παράδειγμα. Ας υποθέσουμε ότι ο ιδιοκτήτης μιας επιχείρησης έχει στην κατοχή του κάποια πολύ σημαντικά έγγραφα τα οποία βρίσκονται σε κάποια θυρίδα που είναι ασφαλισμένη με κάποιο κωδικό. Σε αυτά τα έγγραφα θέλει να έχει πρόσβαση το Διοικητικό Συμβούλιο της εταιρίας ακόμα και στην περίπτωση που αυτός δεν είναι παρόν, π.χ. στην περίπτωση που αυτός ξαφνικά φύγει από τη ζωή. Η μοναδική προϋπόθεση όμως που θέτει είναι πως η πλειοψηφία, ή κάποιο συγκεκριμένο ποσοστό που έχει επιλέξει αυτός, των συμβούλων συμφωνεί στο άνοιγμα της θυρίδας.

Το πρώτο κρυπτογραφικό σχήμα που λύνει το πρόβλημα αυτό παρουσιάστηκε από τον Shamir στην εργασία \cite{10.1145/359168.359176} το 1979 και σήμερα απαντάται στη βιβλιογραφία ως Πρωτόκολλο Διαμοίρασης Μυστικών Shamir. Βασίζεται στο γεγονός ότι οποιοδήποτε σύνολο $n+1$ διαφορετικών μεταξύ τους σημείων σε ένα δυδιάστατο πεδίο $\mathbb{F}^2$ καθορίζει μοναδικά ένα πολυώνυμο $n$ βαθμού. Δηλαδή αν $f:\mathbb{F} \rightarrow \mathbb{F}$, όπου $f(x)=\pn{α}{x}$ τότε ένα σύνολο σημείων $(x_i, f(x_i))$ όπου $\forall i \in [0, n] : x_i \in \mathbb{F}$ είναι διαφορετικά μεταξύ τους, είναι επαρκές για να ανακτήσουμε τη συνάρτηση $f$. Αυτό μπορεί πολύ εύκολα να συμβεί λύνοντας το σύστημα εξισώσεων μεγέθους $(n+1) \cdot (n+1)$ που προκύπτει αν αντικαταστήσουμε με κάθε σημείο τη γενική εξίσωση πολυωνύμου $f(x_i)=\pn{a}{x_i}$. Ένας πιο εύκολος τρόπος να επιτευχθεί αυτό είναι μέσω των πολλαπλασιαστών Lagrange που αναλύθηκαν στην Ενότητα \ref{chapter:appendix}. Παρακάτω παρουσιάζονται οι δύο αλγόριθμοι του Πρωτοκόλλου Διαμοίρασης Μυστικών του Shamir, ένας για την διαμοίραση του μυστικού και ένας για την ανακατασκευή του.

\begin{definition}
\textbf{Σχήμα Διαμοίρασης Μυστικών του Shamir (Shamir's Secret Sharing ή SSS)} : Έστω ένα πεδίο $\mathbb{F}$, $n$ παίκτες $P_0, P_1, P_2, \ldots, P_n$ που συμμετέχουν το πρωτόκολλο και μια τιμή $s \in \mathbb{F}$ που θα θεωρήσουμε ότι είναι το μυστικό που θέλει να διαμοιράσει ο παίκτης $P_0$, τον οποίο αποκαλούμε κάτοχο του μυστικού. Το πρωτόκολλο αυτό χρησιμοποιείται για την διαμοίραση  μυστικού σε $n$ συμμετέχοντες με τρόπο έτσι ώστε να χρειάζεται τουλάχιστον $t$, όπου $t \le n$, να συνεργαστούν ώστε να γίνει η αποκάλυψη του μυστικού.

\begin{mdframed}
    \textbf{Πρωτόκολλο Διαμοίρασης} : Το πρωτόκολλο διαμοίρασης εκτελείται από τον $P_0$ ο οποίος δημιουργεί τις μετοχές των παιχτών και τους τις στέλνει.
    \begin{itemize}
        \item \textbf{Εισόδοι} :
            \begin{itemize}
                \item Κοινή είσοδος : Πεδίο $\mathbb{F}$
                \item Κάτοχος του μυστικού $P_0$ : Μυστικό $s \in \mathbb{F}$
            \end{itemize}
        
        \item \textbf{Πρωτόκολλο} : \\
        \begin{pchstack}[center, boxed]
            \procedure[linenumbering]{P_0} {
                f(x) \sample \mathbb{F}[x] : (deg(f_i(x)) = t+1) \land (f_i(0) = s) \\
                \pcforeach $i$ \pcin $[0, n]$ :\\
                \t p_i \sample f(x)_{x \neq 0} \\
                \pcendfor \\
                \pcforeach i \pcin $[0, 1, \ldots, n]$ \\
                \t    \pclinecomment{Send $p_i$ to $P_i$} \\
                \t    p_i \rightarrow P_i \\
                \pcendfor
            }
        \end{pchstack}
        \item \textbf{Εξόδοι} : \\
            \begin{itemize}
                \item $P_i$ : $p_i$ (\textbf{Μετοχή του συμμετέχοντα } $i$)
            \end{itemize}
    \end{itemize}
\end{mdframed}
Το πρωτόκολλο ανακατασκευής εκτελείται μόνο μεταξύ των συμμετεχόντων που προσπαθούν να ανακατασκευάσουν το μυστικό $s$. Υποθέτουμε ότι μέσω κάποιου καναλιού επικοινωνίας τουλάχιστον $t+1$ από τους συμμετέχοντες συμμετέχοντες έχουν ανταλλάξει τα στοιχεία τους $p_i$ μεταξύ τους.
    \begin{mdframed}
    \item \textbf{Πρωτόκολλο Ανακατασκευής} :
    \begin{itemize}
        \item \textbf{Εισόδοι} :
            \begin{itemize}
                \item Κοινή Είσοδος (των συμμετεχόντων που εκτελούν την ανακατασκευή): $S = \{\text{Σύνολο μετοχών } p_i \}$, όπου $t \le |S| \le n$
            \end{itemize}
        \item \textbf{Πρωτόκολλο} : \\
            \pcb {
                P_i \\ [][\hline]
                L(x) \gets \sum_{p_i \in S} p_i l_j(x) \textrm{, όπου } l_j(x) \textrm{ είναι οι συντελεστές Lagrange}\\
                s \gets L(0)
            }
        \item \textbf{Εξόδοι} :
            \begin{itemize}
                \item Κοινή Έξοδος : $s$
            \end{itemize}
    \end{itemize}
    \end{mdframed}

\end{definition}

Αξίζει να σημειωθεί ότι στη βιβλιογραφία έχουν προταθεί αρκετά πρωτόκολλα για Διαμοίραση Μυστικών. Όπως του Blakley \cite{blakley1979safeguarding}, του Mignotte και των Asmut-Bloom. Το πρώτο βασίζεται στο γεγονός ότι αν πάρουμε $n$ $n$-διάστατα υπερεπιπέδα με την προϋπόθεση ότι ανά δύο δεν είναι παράλληλα τότε όλα έχουν ένα κοινό μονοδιάστατο κοινό σημείο τομής. Έτσι αν θέλουμε να πάρουμε ένα σχήμα Διαμοίρασης Μυστικών με $n$ συμμετέχοντες και κατώφλι $t$, τότε αρκεί να δώσουμε ένα υπερεπίπεδο $t$-οστού βαθμού σε κάθε συμμετέχοντα, δηλαδή συνολικά $n$ υπερεπίπεδα υπό τον περιορισμό ότι όλα τα υπερεπίπεδα τέμνονται σε ένα σημείο το οποίο το επιλέγουμε εξ'αρχής και είναι ο μυστικό μας. Τέλος, μια πολύ χρήσιμη ιδιότητα του σχήματος $SSS$ αλλά και αυτού του Blakley είναι ότι διαθέτουν τέλεια ασφάλεια, που εξηγούμε τι σημαίνει στο επόμενο κεφάλαιο.